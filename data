import tkinter as tk
from tkinter import messagebox
import pandas as pd
import os

def get_completed_booking_value():
    data_dir = "/Users/cindy/Downloads/archive"
    file_name = "ncr_ride_bookings.csv"
    file_path = os.path.join(data_dir, file_name)
    try:
        df = pd.read_csv(file_path)
        # Ensure correct column names
        if "Booking Status" in df.columns and "Booking Value" in df.columns:
            completed_df = df[df["Booking Status"].str.lower() == "completed"]
            total_value = completed_df["Booking Value"].sum()
            result_label.config(text=f"Total Booking Value (Completed): ${total_value:,.2f}")
        else:
            result_label.config(
                text="Columns 'Booking Status' not found in the file."
            )
    except Exception as e:
        messagebox.showerror("Error", f"Could not load data.\n{e}")

root = tk.Tk()
root.title("Completed Booking Value Dashboard")

tk.Label(root, text="Sum booking value where order statue is 'completed':").pack(pady=5)

fetch_button = tk.Button(root, text="Fetch Completed Booking Value", command=get_completed_booking_value)
fetch_button.pack(pady=10)

result_label = tk.Label(root, text="")
result_label.pack(pady=10)

root.mainloop()
